export const charPalExpScript = "const charUrl=window.location.href,platform=window.location.hostname;let authToken=null,tokenResolved=!1;const originalOpen=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(t,e,...a){const n=this.setRequestHeader;this.setRequestHeader=function(t,e){\"authorization\"!==t.toLowerCase()||tokenResolved||(authToken=e.trim(),tokenResolved=!0),n.apply(this,arguments)},originalOpen.apply(this,arguments)};const clickButton=t=>{const e=document.querySelector(t);return!!e&&(e.click(),!0)},fetchProfileImage=async t=>{const e=await fetch(t),a=await e.blob(),n=new FileReader;return new Promise(((t,e)=>{n.onloadend=()=>t(n.result),n.onerror=e,n.readAsDataURL(a)}))},exportCharacter=t=>{const e={image:t.image,name:t.name,personality:t.personality,initialMessage:t.initialMessage,scenario:\"\",alternateInitialMessages:[]},a=`\/\/ Made FOR the Experience. From the unformed, to the spark.\\n\/\/ Handle with care. It remembers.\\n\\n\/\/ ${(new Date).toLocaleString()} at https:\/\/palm.goteamst.com\\n\\n`,n=JSON.stringify(e,null,2),o=new Blob([a+n],{type:\"application\/octet-stream\"}),r=URL.createObjectURL(o),i=document.createElement(\"a\");i.href=r,i.download=`${e.name||\"character\"}-ucm.plmc`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)},exportMethod1=async()=>{try{const t=new URL(`https:\/\/plus.${platform.split(\".\").slice(-2).join(\".\")}\/chat\/character\/info\/`),e=charUrl.split(\"\/\").slice(-1)[0],a=await fetch(t.toString(),{method:\"POST\",headers:{\"Content-Type\":\"application\/json\"},body:JSON.stringify({external_id:e})});if(!a.ok)throw new Error(\"Failed to fetch character info.\");const n=await a.json(),o=new URL(`https:\/\/${platform.split(\".\").slice(-2)[0]}ai.io\/i\/250\/static\/avatars\/${n.character.avatar_file_name}`),r={image:await fetchProfileImage(o.toString()),name:n.character.participant__name,personality:n.character.definition||n.character.description,initialMessage:n.character.greeting};return exportCharacter(r),!0}catch(t){return!1}},exportMethod2=async()=>{try{authToken||(await(async()=>{if(!clickButton(\"#root > div > main > div > div.css-26c7er > div:nth-child(1) > div > div.chakra-stack.css-fu9q4m > div.css-21dtu2 > div.css-1bntj9o > div.css-gmuwbf > button\"))throw new Error(\"Button not found.\");return new Promise(((t,e)=>{const a=setInterval((()=>{authToken&&(clearInterval(a),t(authToken))}),100)}))})(),clickButton(\"#root > div > main > div > div.css-26c7er > div:nth-child(1) > div > div.chakra-stack.css-fu9q4m > div.css-21dtu2 > div.css-1bntj9o > div.css-gmuwbf > button\"));const t=await(async()=>{const t=(()=>{const t=charUrl.match(\/\\\/characters\\\/([a-f0-9-]+)_\/);return t?t[1]:null})(),e=window.location.origin,a=new URL(`\/hampter\/characters\/${t}`,e),n=await fetch(a.toString(),{headers:{Authorization:authToken}});if(!n.ok)throw new Error(\"Failed to fetch character info.\");return n.json()})(),e={image:`https:\/\/ella.${platform.split(\".\").slice(-2).join(\".\")}\/bot-avatars\/${t.avatar}`,name:t.name,personality:t.personality||t.description,initialMessage:t.first_message,scenario:t.scenario};return exportCharacter(e),!0}catch(t){return!1}};(async()=>{if(!await exportMethod1()){await exportMethod2()||alert(`Exporting failed.. Looks like this script isn\'t compatible with ${platform.split(\".\").slice(-2).join(\".\")} yet.`)}})();"